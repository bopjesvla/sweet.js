"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _tokenizer = require("shift-parser/dist/tokenizer");

var _tokenizer2 = _interopRequireDefault(_tokenizer);

var _immutable = require("immutable");

var _syntax = require("./syntax");

var _syntax2 = _interopRequireDefault(_syntax);

var _ramda = require("ramda");

var R = _interopRequireWildcard(_ramda);

var _ramdaFantasy = require("ramda-fantasy");

var _errors = require("./errors");

var _terms = require("./terms");

var _terms2 = _interopRequireDefault(_terms);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Just_492 = _ramdaFantasy.Maybe.Just;
var Nothing_493 = _ramdaFantasy.Maybe.Nothing;

var LSYNTAX_494 = { name: "left-syntax" };
var RSYNTAX_495 = { name: "right-syntax" };
var literalKeywords_496 = ["this", "null", "true", "false"];
var isLeftBracket_497 = R.whereEq({ type: _tokenizer.TokenType.LBRACK });
var isLeftBrace_498 = R.whereEq({ type: _tokenizer.TokenType.LBRACE });
var isLeftParen_499 = R.whereEq({ type: _tokenizer.TokenType.LPAREN });
var isRightBracket_500 = R.whereEq({ type: _tokenizer.TokenType.RBRACK });
var isRightBrace_501 = R.whereEq({ type: _tokenizer.TokenType.RBRACE });
var isRightParen_502 = R.whereEq({ type: _tokenizer.TokenType.RPAREN });
var isEOS_503 = R.whereEq({ type: _tokenizer.TokenType.EOS });
var isHash_504 = R.whereEq({ type: _tokenizer.TokenType.IDENTIFIER, value: "#" });
var isLeftSyntax_505 = R.whereEq({ type: LSYNTAX_494 });
var isRightSyntax_506 = R.whereEq({ type: RSYNTAX_495 });
var isLeftDelimiter_507 = R.anyPass([isLeftBracket_497, isLeftBrace_498, isLeftParen_499, isLeftSyntax_505]);
var isRightDelimiter_508 = R.anyPass([isRightBracket_500, isRightBrace_501, isRightParen_502, isRightSyntax_506]);
var isMatchingDelimiters_509 = R.cond([[isLeftBracket_497, function (__550, b_551) {
  return isRightBracket_500(b_551);
}], [isLeftBrace_498, function (__552, b_553) {
  return isRightBrace_501(b_553);
}], [isLeftParen_499, function (__554, b_555) {
  return isRightParen_502(b_555);
}], [isLeftSyntax_505, function (__556, b_557) {
  return isRightSyntax_506(b_557);
}], [R.T, R.F]]);
var assignOps_510 = ["=", "+=", "-=", "*=", "/=", "%=", "<<=", ">>=", ">>>=", "&=", "|=", "^=", ","];
var binaryOps_511 = ["+", "-", "*", "/", "%", "<<", ">>", ">>>", "&", "|", "^", "&&", "||", "?", ":", "===", "==", ">=", "<=", "<", ">", "!=", "!==", "instanceof"];
var unaryOps_512 = ["++", "--", "~", "!", "delete", "void", "typeof", "yield", "throw", "new"];
var isEmpty_513 = R.whereEq({ size: 0 });
var isPunctuator_514 = function isPunctuator_514(s_558) {
  return s_558.isPunctuator();
};
var isKeyword_515 = function isKeyword_515(s_559) {
  return s_559.isKeyword();
};
var isDelimiter_516 = function isDelimiter_516(s_560) {
  return s_560.isDelimiter();
};
var isParens_517 = function isParens_517(s_561) {
  return s_561.isParens();
};
var isBraces_518 = function isBraces_518(s_562) {
  return s_562.isBraces();
};
var isBrackets_519 = function isBrackets_519(s_563) {
  return s_563.isBrackets();
};
var isIdentifier_520 = function isIdentifier_520(s_564) {
  return s_564.isIdentifier();
};
var val_521 = function val_521(s_565) {
  return s_565.val();
};
var isVal_522 = R.curry(function (v_566, s_567) {
  return s_567.val() === v_566;
});
var isDot_523 = R.allPass([isPunctuator_514, isVal_522(".")]);
var isColon_524 = R.allPass([isPunctuator_514, isVal_522(":")]);
var isFunctionKeyword_525 = R.allPass([isKeyword_515, isVal_522("function")]);
var isOperator_526 = function isOperator_526(s_568) {
  return (s_568.isPunctuator() || s_568.isKeyword()) && R.any(R.equals(s_568.val()), assignOps_510.concat(binaryOps_511).concat(unaryOps_512));
};
var isNonLiteralKeyword_527 = R.allPass([isKeyword_515, function (s_569) {
  return R.none(R.equals(s_569.val()), literalKeywords_496);
}]);
var isKeywordExprPrefix_528 = R.allPass([isKeyword_515, function (s_570) {
  return R.any(R.equals(s_570.val()), ["instanceof", "typeof", "delete", "void", "yield", "throw", "new", "case"]);
}]);
var last_529 = function last_529(p_571) {
  return p_571.last();
};
var safeLast_530 = R.pipe(R.cond([[isEmpty_513, R.always(Nothing_493())], [R.T, R.compose(_ramdaFantasy.Maybe.of, last_529)]]));
var stuffTrue_531 = R.curry(function (p_572, b_573) {
  return b_573 ? Just_492(p_572) : Nothing_493();
});
var stuffFalse_532 = R.curry(function (p_574, b_575) {
  return !b_575 ? Just_492(p_574) : Nothing_493();
});
var isTopColon_533 = R.pipe(safeLast_530, R.map(isColon_524), _ramdaFantasy.Maybe.maybe(false, R.identity));
var isTopPunctuator_534 = R.pipe(safeLast_530, R.map(isPunctuator_514), _ramdaFantasy.Maybe.maybe(false, R.identity));
var isExprReturn_535 = R.curry(function (l_576, p_577) {
  var retKwd_578 = safeLast_530(p_577);
  var maybeDot_579 = pop_546(p_577).chain(safeLast_530);
  if (maybeDot_579.map(isDot_523).getOrElse(false)) {
    return true;
  }
  return retKwd_578.map(function (s_580) {
    return s_580.isKeyword() && s_580.val() === "return" && s_580.lineNumber() === l_576;
  }).getOrElse(false);
});
var isTopOperator_536 = R.pipe(safeLast_530, R.map(isOperator_526), _ramdaFantasy.Maybe.maybe(false, R.identity));
var isTopKeywordExprPrefix_537 = R.pipe(safeLast_530, R.map(isKeywordExprPrefix_528), _ramdaFantasy.Maybe.maybe(false, R.identity));
var isExprPrefix_538 = R.curry(function (l_581, b_582) {
  return R.cond([[isEmpty_513, R.always(b_582)], [isTopColon_533, R.always(b_582)], [isTopKeywordExprPrefix_537, R.T], [isTopOperator_536, R.T], [isTopPunctuator_534, R.always(b_582)], [isExprReturn_535(l_581), R.T], [R.T, R.F]]);
});
var curly_539 = function curly_539(p_583) {
  return safeLast_530(p_583).map(isBraces_518).chain(stuffTrue_531(p_583));
};
var paren_540 = function paren_540(p_584) {
  return safeLast_530(p_584).map(isParens_517).chain(stuffTrue_531(p_584));
};
var func_541 = function func_541(p_585) {
  return safeLast_530(p_585).map(isFunctionKeyword_525).chain(stuffTrue_531(p_585));
};
var ident_542 = function ident_542(p_586) {
  return safeLast_530(p_586).map(isIdentifier_520).chain(stuffTrue_531(p_586));
};
var nonLiteralKeyword_543 = function nonLiteralKeyword_543(p_587) {
  return safeLast_530(p_587).map(isNonLiteralKeyword_527).chain(stuffTrue_531(p_587));
};
var opt_544 = R.curry(function (a_588, b_589, p_590) {
  var result_591 = R.pipeK(a_588, b_589)(_ramdaFantasy.Maybe.of(p_590));
  return _ramdaFantasy.Maybe.isJust(result_591) ? result_591 : _ramdaFantasy.Maybe.of(p_590);
});
var notDot_545 = R.ifElse(R.whereEq({ size: 0 }), Just_492, function (p_592) {
  return safeLast_530(p_592).map(function (s_593) {
    return !(s_593.isPunctuator() && s_593.val() === ".");
  }).chain(stuffTrue_531(p_592));
});
var pop_546 = R.compose(Just_492, function (p_594) {
  return p_594.pop();
});
var functionPrefix_547 = R.pipeK(curly_539, pop_546, paren_540, pop_546, opt_544(ident_542, pop_546), func_541);
var isRegexPrefix_548 = function isRegexPrefix_548(b_595) {
  return R.anyPass([isEmpty_513, isTopPunctuator_534, R.pipe(_ramdaFantasy.Maybe.of, R.pipeK(nonLiteralKeyword_543, pop_546, notDot_545), _ramdaFantasy.Maybe.isJust), R.pipe(_ramdaFantasy.Maybe.of, R.pipeK(paren_540, pop_546, nonLiteralKeyword_543, pop_546, notDot_545), _ramdaFantasy.Maybe.isJust), R.pipe(_ramdaFantasy.Maybe.of, functionPrefix_547, R.chain(function (p_596) {
    return safeLast_530(p_596).map(function (s_597) {
      return s_597.lineNumber();
    }).chain(function (fnLine_598) {
      return pop_546(p_596).map(isExprPrefix_538(fnLine_598, b_595));
    }).chain(stuffFalse_532(p_596));
  }), _ramdaFantasy.Maybe.isJust), function (p_599) {
    var isCurly_600 = _ramdaFantasy.Maybe.isJust(safeLast_530(p_599).map(isBraces_518));
    var alreadyCheckedFunction_601 = R.pipe(_ramdaFantasy.Maybe.of, functionPrefix_547, _ramdaFantasy.Maybe.isJust)(p_599);
    if (alreadyCheckedFunction_601) {
      return false;
    }
    return R.pipe(_ramdaFantasy.Maybe.of, R.chain(curly_539), R.chain(function (p_602) {
      return safeLast_530(p_602).map(function (s_603) {
        return s_603.lineNumber();
      }).chain(function (curlyLine_604) {
        return pop_546(p_602).map(isExprPrefix_538(curlyLine_604, b_595));
      }).chain(stuffFalse_532(p_602));
    }), _ramdaFantasy.Maybe.isJust)(p_599);
  }]);
};
function lastEl_549(l_605) {
  return l_605[l_605.length - 1];
}

var Reader = (function (_Tokenizer) {
  _inherits(Reader, _Tokenizer);

  function Reader(strings_606, context_607, replacements_608) {
    _classCallCheck(this, Reader);

    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Reader).call(this, Array.isArray(strings_606) ? strings_606.join("") : strings_606));

    _this.delimStack = new Map();
    _this.insideSyntaxTemplate = [false];
    _this.context = context_607;
    if (Array.isArray(strings_606)) {
      (function () {
        var totalIndex = 0;
        _this.replacementIndex = R.reduce(function (acc_609, strRep_610) {
          acc_609.push({ index: totalIndex + strRep_610[0].length, replacement: strRep_610[1] });
          totalIndex += strRep_610[0].length;
          return acc_609;
        }, [], R.zip(strings_606, replacements_608));
      })();
    }
    return _this;
  }

  _createClass(Reader, [{
    key: "read",
    value: function read() {
      var stack_611 = arguments.length <= 0 || arguments[0] === undefined ? [] : arguments[0];
      var b_612 = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
      var singleDelimiter_613 = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

      var prefix_614 = (0, _immutable.List)();
      while (true) {
        var tok = this.advance(prefix_614, b_612);
        if (tok instanceof _syntax2.default || tok instanceof _terms2.default) {
          stack_611.push(tok);
          continue;
        }
        if (Array.isArray(tok)) {
          Array.prototype.push.apply(stack_611, tok);
          continue;
        }
        if (_immutable.List.isList(tok)) {
          Array.prototype.push.apply(stack_611, tok.toArray());
          continue;
        }
        if (isEOS_503(tok)) {
          if (stack_611[0] && isLeftDelimiter_507(stack_611[0].token)) {
            throw this.createUnexpected(tok);
          }
          break;
        }
        if (isLeftDelimiter_507(tok)) {
          if (isLeftSyntax_505(tok)) {
            this.insideSyntaxTemplate.push(true);
          }
          var line = tok.slice.startLocation.line;
          var innerB = isLeftBrace_498(tok) ? isExprPrefix_538(line, b_612)(prefix_614) : true;
          var inner = this.read([new _syntax2.default(tok)], innerB, false);
          var stx = new _syntax2.default(inner, this.context);
          prefix_614 = prefix_614.concat(stx);
          stack_611.push(stx);
          if (singleDelimiter_613) {
            break;
          }
        } else if (isRightDelimiter_508(tok)) {
          if (stack_611[0] && !isMatchingDelimiters_509(stack_611[0].token, tok)) {
            throw this.createUnexpected(tok);
          }
          var stx = new _syntax2.default(tok, this.context);
          stack_611.push(stx);
          if (lastEl_549(this.insideSyntaxTemplate) && isRightSyntax_506(tok)) {
            this.insideSyntaxTemplate.pop();
          }
          break;
        } else {
          var stx = new _syntax2.default(tok, this.context);
          prefix_614 = prefix_614.concat(stx);
          stack_611.push(stx);
        }
      }
      return (0, _immutable.List)(stack_611);
    }
  }, {
    key: "advance",
    value: function advance(prefix_615, b_616) {
      var startLocation_617 = this.getLocation();
      this.lastIndex = this.index;
      this.lastLine = this.line;
      this.lastLineStart = this.lineStart;
      this.skipComment();
      this.startIndex = this.index;
      this.startLine = this.line;
      this.startLineStart = this.lineStart;
      if (this.replacementIndex && this.replacementIndex[0] && this.index >= this.replacementIndex[0].index) {
        var rep = this.replacementIndex[0].replacement;
        this.replacementIndex.shift();
        return rep;
      }
      var charCode_618 = this.source.charCodeAt(this.index);
      if (charCode_618 === 96) {
        var element = undefined,
            items = [];
        var _startLocation_ = this.getLocation();
        var start = this.index;
        this.index++;
        if (lastEl_549(this.insideSyntaxTemplate)) {
          var slice = this.getSlice(start, _startLocation_);
          return { type: RSYNTAX_495, value: "`", slice: slice };
        }
        do {
          element = this.scanTemplateElement();
          items.push(element);
          if (element.interp) {
            element = this.read([], false, true);
            (0, _errors.assert)(element.size === 1, "should only have read a single delimiter inside a template");
            items.push(element.get(0));
          }
        } while (!element.tail);
        return { type: _tokenizer.TokenType.TEMPLATE, items: (0, _immutable.List)(items) };
      } else if (charCode_618 === 35) {
        var _startLocation_2 = this.getLocation();
        var start = this.index;
        var slice = this.getSlice(start, _startLocation_2);
        this.index++;
        if (this.source.charCodeAt(this.index) === 96) {
          this.index++;
          return { type: LSYNTAX_494, value: "#`", slice: slice };
        }
        return { type: _tokenizer.TokenType.IDENTIFIER, value: "#", slice: slice };
      }
      var lookahead_619 = _get(Object.getPrototypeOf(Reader.prototype), "advance", this).call(this);
      if (lookahead_619.type === _tokenizer.TokenType.DIV && isRegexPrefix_548(b_616)(prefix_615)) {
        return _get(Object.getPrototypeOf(Reader.prototype), "scanRegExp", this).call(this, "/");
      }
      return lookahead_619;
    }
  }, {
    key: "scanTemplateElement",
    value: function scanTemplateElement() {
      var startLocation_620 = this.getLocation();
      var start_621 = this.index;
      while (this.index < this.source.length) {
        var ch = this.source.charCodeAt(this.index);
        switch (ch) {
          case 96:
            var slice = this.getSlice(start_621, startLocation_620);
            this.index++;
            return { type: _tokenizer.TokenType.TEMPLATE, tail: true, interp: false, slice: slice };
          case 36:
            if (this.source.charCodeAt(this.index + 1) === 123) {
              var _slice = this.getSlice(start_621, startLocation_620);
              this.index += 1;
              return { type: _tokenizer.TokenType.TEMPLATE, tail: false, interp: true, slice: _slice };
            }
            this.index++;
            break;
          case 92:
            {
              var octal = this.scanStringEscape("", null)[1];
              if (octal != null) {
                throw this.createILLEGAL();
              }
              break;
            }
          default:
            this.index++;
        }
      }
      throw this.createILLEGAL();
    }
  }]);

  return Reader;
})(_tokenizer2.default);

exports.default = Reader;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3N3ZWV0L3NoaWZ0LXJlYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBSWEsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHZCxJQUFNLFFBQVEsR0FBRyxvQkFBTSxJQUFJLENBQUM7QUFDNUIsSUFBTSxXQUFXLEdBQUcsb0JBQU0sT0FBTyxDQUFDOztBQUVsQyxJQUFNLFdBQVcsR0FBRyxFQUFDLElBQUksRUFBRSxhQUFhLEVBQUMsQ0FBQztBQUMxQyxJQUFNLFdBQVcsR0FBRyxFQUFDLElBQUksRUFBRSxjQUFjLEVBQUMsQ0FBQztBQUMzQyxJQUFNLG1CQUFtQixHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDOUQsSUFBTSxpQkFBaUIsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUMsSUFBSSxFQUFFLHFCQUFVLE1BQU0sRUFBQyxDQUFDLENBQUM7QUFDOUQsSUFBTSxlQUFlLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFDLElBQUksRUFBRSxxQkFBVSxNQUFNLEVBQUMsQ0FBQyxDQUFDO0FBQzVELElBQU0sZUFBZSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxJQUFJLEVBQUUscUJBQVUsTUFBTSxFQUFDLENBQUMsQ0FBQztBQUM1RCxJQUFNLGtCQUFrQixHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxJQUFJLEVBQUUscUJBQVUsTUFBTSxFQUFDLENBQUMsQ0FBQztBQUMvRCxJQUFNLGdCQUFnQixHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxJQUFJLEVBQUUscUJBQVUsTUFBTSxFQUFDLENBQUMsQ0FBQztBQUM3RCxJQUFNLGdCQUFnQixHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxJQUFJLEVBQUUscUJBQVUsTUFBTSxFQUFDLENBQUMsQ0FBQztBQUM3RCxJQUFNLFNBQVMsR0FBRyxDQUFD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QUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMvQyxrQkFBSSxLQUFLLElBQUksSUFBSSxFQUFFO0FBQ2pCLHNCQUFNLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztlQUM1QjtBQUNELG9CQUFNO2FBQ1A7QUFBQSxBQUNIO0FBQ0UsZ0JBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUFBLFNBQ2hCO09BQ0Y7QUFDRCxZQUFNLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztLQUM1Qjs7O1NBdEprQixNQUFNOzs7a0JBQU4sTUFBTSIsImZpbGUiOiJzaGlmdC1yZWFkZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVG9rZW5pemVyIGZyb20gXCJzaGlmdC1wYXJzZXIvZGlzdC90b2tlbml6ZXJcIjtcbmltcG9ydCB7VG9rZW5DbGFzcywgVG9rZW5UeXBlfSBmcm9tIFwic2hpZnQtcGFyc2VyL2Rpc3QvdG9rZW5pemVyXCI7XG5pbXBvcnQge0xpc3R9IGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCBTeW50YXggZnJvbSBcIi4vc3ludGF4XCI7XG5pbXBvcnQgICogYXMgUiBmcm9tIFwicmFtZGFcIjtcbmltcG9ydCB7TWF5YmV9IGZyb20gXCJyYW1kYS1mYW50YXN5XCI7XG5pbXBvcnQge2Fzc2VydH0gZnJvbSBcIi4vZXJyb3JzXCI7XG5jb25zdCBKdXN0XzQ5MiA9IE1heWJlLkp1c3Q7XG5jb25zdCBOb3RoaW5nXzQ5MyA9IE1heWJlLk5vdGhpbmc7XG5pbXBvcnQgVGVybSBmcm9tIFwiLi90ZXJtc1wiO1xuY29uc3QgTFNZTlRBWF80OTQgPSB7bmFtZTogXCJsZWZ0LXN5bnRheFwifTtcbmNvbnN0IFJTWU5UQVhfNDk1ID0ge25hbWU6IFwicmlnaHQtc3ludGF4XCJ9O1xuY29uc3QgbGl0ZXJhbEtleXdvcmRzXzQ5NiA9IFtcInRoaXNcIiwgXCJudWxsXCIsIFwidHJ1ZVwiLCBcImZhbHNlXCJdO1xuY29uc3QgaXNMZWZ0QnJhY2tldF80OTcgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5MQlJBQ0t9KTtcbmNvbnN0IGlzTGVmdEJyYWNlXzQ5OCA9IFIud2hlcmVFcSh7dHlwZTogVG9rZW5UeXBlLkxCUkFDRX0pO1xuY29uc3QgaXNMZWZ0UGFyZW5fNDk5ID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuTFBBUkVOfSk7XG5jb25zdCBpc1JpZ2h0QnJhY2tldF81MDAgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5SQlJBQ0t9KTtcbmNvbnN0IGlzUmlnaHRCcmFjZV81MDEgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5SQlJBQ0V9KTtcbmNvbnN0IGlzUmlnaHRQYXJlbl81MDIgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5SUEFSRU59KTtcbmNvbnN0IGlzRU9TXzUwMyA9IFIud2hlcmVFcSh7dHlwZTogVG9rZW5UeXBlLkVPU30pO1xuY29uc3QgaXNIYXNoXzUwNCA9IFIud2hlcmVFcSh7dHlwZTogVG9rZW5UeXBlLklERU5USUZJRVIsIHZhbHVlOiBcIiNcIn0pO1xuY29uc3QgaXNMZWZ0U3ludGF4XzUwNSA9IFIud2hlcmVFcSh7dHlwZTogTFNZTlRBWF80OTR9KTtcbmNvbnN0IGlzUmlnaHRTeW50YXhfNTA2ID0gUi53aGVyZUVxKHt0eXBlOiBSU1lOVEFYXzQ5NX0pO1xuY29uc3QgaXNMZWZ0RGVsaW1pdGVyXzUwNyA9IFIuYW55UGFzcyhbaXNMZWZ0QnJhY2tldF80OTcsIGlzTGVmdEJyYWNlXzQ5OCwgaXNMZWZ0UGFyZW5fNDk5LCBpc0xlZnRTeW50YXhfNTA1XSk7XG5jb25zdCBpc1JpZ2h0RGVsaW1pdGVyXzUwOCA9IFIuYW55UGFzcyhbaXNSaWdodEJyYWNrZXRfNTAwLCBpc1JpZ2h0QnJhY2VfNTAxLCBpc1JpZ2h0UGFyZW5fNTAyLCBpc1JpZ2h0U3ludGF4XzUwNl0pO1xuY29uc3QgaXNNYXRjaGluZ0RlbGltaXRlcnNfNTA5ID0gUi5jb25kKFtbaXNMZWZ0QnJhY2tldF80OTcsIChfXzU1MCwgYl81NTEpID0+IGlzUmlnaHRCcmFja2V0XzUwMChiXzU1MSldLCBbaXNMZWZ0QnJhY2VfNDk4LCAoX181NTIsIGJfNTUzKSA9PiBpc1JpZ2h0QnJhY2VfNTAxKGJfNTUzKV0sIFtpc0xlZnRQYXJlbl80OTksIChfXzU1NCwgYl81NTUpID0+IGlzUmlnaHRQYXJlbl81MDIoYl81NTUpXSwgW2lzTGVmdFN5bnRheF81MDUsIChfXzU1NiwgYl81NTcpID0+IGlzUmlnaHRTeW50YXhfNTA2KGJfNTU3KV0sIFtSLlQsIFIuRl1dKTtcbmNvbnN0IGFzc2lnbk9wc181MTAgPSBbXCI9XCIsIFwiKz1cIiwgXCItPVwiLCBcIio9XCIsIFwiLz1cIiwgXCIlPVwiLCBcIjw8PVwiLCBcIj4+PVwiLCBcIj4+Pj1cIiwgXCImPVwiLCBcInw9XCIsIFwiXj1cIiwgXCIsXCJdO1xuY29uc3QgYmluYXJ5T3BzXzUxMSA9IFtcIitcIiwgXCItXCIsIFwiKlwiLCBcIi9cIiwgXCIlXCIsIFwiPDxcIiwgXCI+PlwiLCBcIj4+PlwiLCBcIiZcIiwgXCJ8XCIsIFwiXlwiLCBcIiYmXCIsIFwifHxcIiwgXCI/XCIsIFwiOlwiLCBcIj09PVwiLCBcIj09XCIsIFwiPj1cIiwgXCI8PVwiLCBcIjxcIiwgXCI+XCIsIFwiIT1cIiwgXCIhPT1cIiwgXCJpbnN0YW5jZW9mXCJdO1xuY29uc3QgdW5hcnlPcHNfNTEyID0gW1wiKytcIiwgXCItLVwiLCBcIn5cIiwgXCIhXCIsIFwiZGVsZXRlXCIsIFwidm9pZFwiLCBcInR5cGVvZlwiLCBcInlpZWxkXCIsIFwidGhyb3dcIiwgXCJuZXdcIl07XG5jb25zdCBpc0VtcHR5XzUxMyA9IFIud2hlcmVFcSh7c2l6ZTogMH0pO1xuY29uc3QgaXNQdW5jdHVhdG9yXzUxNCA9IHNfNTU4ID0+IHNfNTU4LmlzUHVuY3R1YXRvcigpO1xuY29uc3QgaXNLZXl3b3JkXzUxNSA9IHNfNTU5ID0+IHNfNTU5LmlzS2V5d29yZCgpO1xuY29uc3QgaXNEZWxpbWl0ZXJfNTE2ID0gc181NjAgPT4gc181NjAuaXNEZWxpbWl0ZXIoKTtcbmNvbnN0IGlzUGFyZW5zXzUxNyA9IHNfNTYxID0+IHNfNTYxLmlzUGFyZW5zKCk7XG5jb25zdCBpc0JyYWNlc181MTggPSBzXzU2MiA9PiBzXzU2Mi5pc0JyYWNlcygpO1xuY29uc3QgaXNCcmFja2V0c181MTkgPSBzXzU2MyA9PiBzXzU2My5pc0JyYWNrZXRzKCk7XG5jb25zdCBpc0lkZW50aWZpZXJfNTIwID0gc181NjQgPT4gc181NjQuaXNJZGVudGlmaWVyKCk7XG5jb25zdCB2YWxfNTIxID0gc181NjUgPT4gc181NjUudmFsKCk7XG5jb25zdCBpc1ZhbF81MjIgPSBSLmN1cnJ5KCh2XzU2Niwgc181NjcpID0+IHNfNTY3LnZhbCgpID09PSB2XzU2Nik7XG5jb25zdCBpc0RvdF81MjMgPSBSLmFsbFBhc3MoW2lzUHVuY3R1YXRvcl81MTQsIGlzVmFsXzUyMihcIi5cIildKTtcbmNvbnN0IGlzQ29sb25fNTI0ID0gUi5hbGxQYXNzKFtpc1B1bmN0dWF0b3JfNTE0LCBpc1ZhbF81MjIoXCI6XCIpXSk7XG5jb25zdCBpc0Z1bmN0aW9uS2V5d29yZF81MjUgPSBSLmFsbFBhc3MoW2lzS2V5d29yZF81MTUsIGlzVmFsXzUyMihcImZ1bmN0aW9uXCIpXSk7XG5jb25zdCBpc09wZXJhdG9yXzUyNiA9IHNfNTY4ID0+IChzXzU2OC5pc1B1bmN0dWF0b3IoKSB8fCBzXzU2OC5pc0tleXdvcmQoKSkgJiYgUi5hbnkoUi5lcXVhbHMoc181NjgudmFsKCkpLCBhc3NpZ25PcHNfNTEwLmNvbmNhdChiaW5hcnlPcHNfNTExKS5jb25jYXQodW5hcnlPcHNfNTEyKSk7XG5jb25zdCBpc05vbkxpdGVyYWxLZXl3b3JkXzUyNyA9IFIuYWxsUGFzcyhbaXNLZXl3b3JkXzUxNSwgc181NjkgPT4gUi5ub25lKFIuZXF1YWxzKHNfNTY5LnZhbCgpKSwgbGl0ZXJhbEtleXdvcmRzXzQ5NildKTtcbmNvbnN0IGlzS2V5d29yZEV4cHJQcmVmaXhfNTI4ID0gUi5hbGxQYXNzKFtpc0tleXdvcmRfNTE1LCBzXzU3MCA9PiBSLmFueShSLmVxdWFscyhzXzU3MC52YWwoKSksIFtcImluc3RhbmNlb2ZcIiwgXCJ0eXBlb2ZcIiwgXCJkZWxldGVcIiwgXCJ2b2lkXCIsIFwieWllbGRcIiwgXCJ0aHJvd1wiLCBcIm5ld1wiLCBcImNhc2VcIl0pXSk7XG5sZXQgbGFzdF81MjkgPSBwXzU3MSA9PiBwXzU3MS5sYXN0KCk7XG5sZXQgc2FmZUxhc3RfNTMwID0gUi5waXBlKFIuY29uZChbW2lzRW1wdHlfNTEzLCBSLmFsd2F5cyhOb3RoaW5nXzQ5MygpKV0sIFtSLlQsIFIuY29tcG9zZShNYXliZS5vZiwgbGFzdF81MjkpXV0pKTtcbmxldCBzdHVmZlRydWVfNTMxID0gUi5jdXJyeSgocF81NzIsIGJfNTczKSA9PiBiXzU3MyA/IEp1c3RfNDkyKHBfNTcyKSA6IE5vdGhpbmdfNDkzKCkpO1xubGV0IHN0dWZmRmFsc2VfNTMyID0gUi5jdXJyeSgocF81NzQsIGJfNTc1KSA9PiAhYl81NzUgPyBKdXN0XzQ5MihwXzU3NCkgOiBOb3RoaW5nXzQ5MygpKTtcbmxldCBpc1RvcENvbG9uXzUzMyA9IFIucGlwZShzYWZlTGFzdF81MzAsIFIubWFwKGlzQ29sb25fNTI0KSwgTWF5YmUubWF5YmUoZmFsc2UsIFIuaWRlbnRpdHkpKTtcbmxldCBpc1RvcFB1bmN0dWF0b3JfNTM0ID0gUi5waXBlKHNhZmVMYXN0XzUzMCwgUi5tYXAoaXNQdW5jdHVhdG9yXzUxNCksIE1heWJlLm1heWJlKGZhbHNlLCBSLmlkZW50aXR5KSk7XG5sZXQgaXNFeHByUmV0dXJuXzUzNSA9IFIuY3VycnkoKGxfNTc2LCBwXzU3NykgPT4ge1xuICBsZXQgcmV0S3dkXzU3OCA9IHNhZmVMYXN0XzUzMChwXzU3Nyk7XG4gIGxldCBtYXliZURvdF81NzkgPSBwb3BfNTQ2KHBfNTc3KS5jaGFpbihzYWZlTGFzdF81MzApO1xuICBpZiAobWF5YmVEb3RfNTc5Lm1hcChpc0RvdF81MjMpLmdldE9yRWxzZShmYWxzZSkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gcmV0S3dkXzU3OC5tYXAoc181ODAgPT4ge1xuICAgIHJldHVybiBzXzU4MC5pc0tleXdvcmQoKSAmJiBzXzU4MC52YWwoKSA9PT0gXCJyZXR1cm5cIiAmJiBzXzU4MC5saW5lTnVtYmVyKCkgPT09IGxfNTc2O1xuICB9KS5nZXRPckVsc2UoZmFsc2UpO1xufSk7XG5jb25zdCBpc1RvcE9wZXJhdG9yXzUzNiA9IFIucGlwZShzYWZlTGFzdF81MzAsIFIubWFwKGlzT3BlcmF0b3JfNTI2KSwgTWF5YmUubWF5YmUoZmFsc2UsIFIuaWRlbnRpdHkpKTtcbmNvbnN0IGlzVG9wS2V5d29yZEV4cHJQcmVmaXhfNTM3ID0gUi5waXBlKHNhZmVMYXN0XzUzMCwgUi5tYXAoaXNLZXl3b3JkRXhwclByZWZpeF81MjgpLCBNYXliZS5tYXliZShmYWxzZSwgUi5pZGVudGl0eSkpO1xubGV0IGlzRXhwclByZWZpeF81MzggPSBSLmN1cnJ5KChsXzU4MSwgYl81ODIpID0+IFIuY29uZChbW2lzRW1wdHlfNTEzLCBSLmFsd2F5cyhiXzU4MildLCBbaXNUb3BDb2xvbl81MzMsIFIuYWx3YXlzKGJfNTgyKV0sIFtpc1RvcEtleXdvcmRFeHByUHJlZml4XzUzNywgUi5UXSwgW2lzVG9wT3BlcmF0b3JfNTM2LCBSLlRdLCBbaXNUb3BQdW5jdHVhdG9yXzUzNCwgUi5hbHdheXMoYl81ODIpXSwgW2lzRXhwclJldHVybl81MzUobF81ODEpLCBSLlRdLCBbUi5ULCBSLkZdXSkpO1xubGV0IGN1cmx5XzUzOSA9IHBfNTgzID0+IHNhZmVMYXN0XzUzMChwXzU4MykubWFwKGlzQnJhY2VzXzUxOCkuY2hhaW4oc3R1ZmZUcnVlXzUzMShwXzU4MykpO1xubGV0IHBhcmVuXzU0MCA9IHBfNTg0ID0+IHNhZmVMYXN0XzUzMChwXzU4NCkubWFwKGlzUGFyZW5zXzUxNykuY2hhaW4oc3R1ZmZUcnVlXzUzMShwXzU4NCkpO1xubGV0IGZ1bmNfNTQxID0gcF81ODUgPT4gc2FmZUxhc3RfNTMwKHBfNTg1KS5tYXAoaXNGdW5jdGlvbktleXdvcmRfNTI1KS5jaGFpbihzdHVmZlRydWVfNTMxKHBfNTg1KSk7XG5sZXQgaWRlbnRfNTQyID0gcF81ODYgPT4gc2FmZUxhc3RfNTMwKHBfNTg2KS5tYXAoaXNJZGVudGlmaWVyXzUyMCkuY2hhaW4oc3R1ZmZUcnVlXzUzMShwXzU4NikpO1xubGV0IG5vbkxpdGVyYWxLZXl3b3JkXzU0MyA9IHBfNTg3ID0+IHNhZmVMYXN0XzUzMChwXzU4NykubWFwKGlzTm9uTGl0ZXJhbEtleXdvcmRfNTI3KS5jaGFpbihzdHVmZlRydWVfNTMxKHBfNTg3KSk7XG5sZXQgb3B0XzU0NCA9IFIuY3VycnkoKGFfNTg4LCBiXzU4OSwgcF81OTApID0+IHtcbiAgbGV0IHJlc3VsdF81OTEgPSBSLnBpcGVLKGFfNTg4LCBiXzU4OSkoTWF5YmUub2YocF81OTApKTtcbiAgcmV0dXJuIE1heWJlLmlzSnVzdChyZXN1bHRfNTkxKSA/IHJlc3VsdF81OTEgOiBNYXliZS5vZihwXzU5MCk7XG59KTtcbmxldCBub3REb3RfNTQ1ID0gUi5pZkVsc2UoUi53aGVyZUVxKHtzaXplOiAwfSksIEp1c3RfNDkyLCBwXzU5MiA9PiBzYWZlTGFzdF81MzAocF81OTIpLm1hcChzXzU5MyA9PiAhKHNfNTkzLmlzUHVuY3R1YXRvcigpICYmIHNfNTkzLnZhbCgpID09PSBcIi5cIikpLmNoYWluKHN0dWZmVHJ1ZV81MzEocF81OTIpKSk7XG5sZXQgcG9wXzU0NiA9IFIuY29tcG9zZShKdXN0XzQ5MiwgcF81OTQgPT4gcF81OTQucG9wKCkpO1xuY29uc3QgZnVuY3Rpb25QcmVmaXhfNTQ3ID0gUi5waXBlSyhjdXJseV81MzksIHBvcF81NDYsIHBhcmVuXzU0MCwgcG9wXzU0Niwgb3B0XzU0NChpZGVudF81NDIsIHBvcF81NDYpLCBmdW5jXzU0MSk7XG5jb25zdCBpc1JlZ2V4UHJlZml4XzU0OCA9IGJfNTk1ID0+IFIuYW55UGFzcyhbaXNFbXB0eV81MTMsIGlzVG9wUHVuY3R1YXRvcl81MzQsIFIucGlwZShNYXliZS5vZiwgUi5waXBlSyhub25MaXRlcmFsS2V5d29yZF81NDMsIHBvcF81NDYsIG5vdERvdF81NDUpLCBNYXliZS5pc0p1c3QpLCBSLnBpcGUoTWF5YmUub2YsIFIucGlwZUsocGFyZW5fNTQwLCBwb3BfNTQ2LCBub25MaXRlcmFsS2V5d29yZF81NDMsIHBvcF81NDYsIG5vdERvdF81NDUpLCBNYXliZS5pc0p1c3QpLCBSLnBpcGUoTWF5YmUub2YsIGZ1bmN0aW9uUHJlZml4XzU0NywgUi5jaGFpbihwXzU5NiA9PiB7XG4gIHJldHVybiBzYWZlTGFzdF81MzAocF81OTYpLm1hcChzXzU5NyA9PiBzXzU5Ny5saW5lTnVtYmVyKCkpLmNoYWluKGZuTGluZV81OTggPT4ge1xuICAgIHJldHVybiBwb3BfNTQ2KHBfNTk2KS5tYXAoaXNFeHByUHJlZml4XzUzOChmbkxpbmVfNTk4LCBiXzU5NSkpO1xuICB9KS5jaGFpbihzdHVmZkZhbHNlXzUzMihwXzU5NikpO1xufSksIE1heWJlLmlzSnVzdCksIHBfNTk5ID0+IHtcbiAgbGV0IGlzQ3VybHlfNjAwID0gTWF5YmUuaXNKdXN0KHNhZmVMYXN0XzUzMChwXzU5OSkubWFwKGlzQnJhY2VzXzUxOCkpO1xuICBsZXQgYWxyZWFkeUNoZWNrZWRGdW5jdGlvbl82MDEgPSBSLnBpcGUoTWF5YmUub2YsIGZ1bmN0aW9uUHJlZml4XzU0NywgTWF5YmUuaXNKdXN0KShwXzU5OSk7XG4gIGlmIChhbHJlYWR5Q2hlY2tlZEZ1bmN0aW9uXzYwMSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gUi5waXBlKE1heWJlLm9mLCBSLmNoYWluKGN1cmx5XzUzOSksIFIuY2hhaW4ocF82MDIgPT4ge1xuICAgIHJldHVybiBzYWZlTGFzdF81MzAocF82MDIpLm1hcChzXzYwMyA9PiBzXzYwMy5saW5lTnVtYmVyKCkpLmNoYWluKGN1cmx5TGluZV82MDQgPT4ge1xuICAgICAgcmV0dXJuIHBvcF81NDYocF82MDIpLm1hcChpc0V4cHJQcmVmaXhfNTM4KGN1cmx5TGluZV82MDQsIGJfNTk1KSk7XG4gICAgfSkuY2hhaW4oc3R1ZmZGYWxzZV81MzIocF82MDIpKTtcbiAgfSksIE1heWJlLmlzSnVzdCkocF81OTkpO1xufV0pO1xuZnVuY3Rpb24gbGFzdEVsXzU0OShsXzYwNSkge1xuICByZXR1cm4gbF82MDVbbF82MDUubGVuZ3RoIC0gMV07XG59XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWFkZXIgZXh0ZW5kcyBUb2tlbml6ZXIge1xuICBjb25zdHJ1Y3RvcihzdHJpbmdzXzYwNiwgY29udGV4dF82MDcsIHJlcGxhY2VtZW50c182MDgpIHtcbiAgICBzdXBlcihBcnJheS5pc0FycmF5KHN0cmluZ3NfNjA2KSA/IHN0cmluZ3NfNjA2LmpvaW4oXCJcIikgOiBzdHJpbmdzXzYwNik7XG4gICAgdGhpcy5kZWxpbVN0YWNrID0gbmV3IE1hcDtcbiAgICB0aGlzLmluc2lkZVN5bnRheFRlbXBsYXRlID0gW2ZhbHNlXTtcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0XzYwNztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShzdHJpbmdzXzYwNikpIHtcbiAgICAgIGxldCB0b3RhbEluZGV4ID0gMDtcbiAgICAgIHRoaXMucmVwbGFjZW1lbnRJbmRleCA9IFIucmVkdWNlKChhY2NfNjA5LCBzdHJSZXBfNjEwKSA9PiB7XG4gICAgICAgIGFjY182MDkucHVzaCh7aW5kZXg6IHRvdGFsSW5kZXggKyBzdHJSZXBfNjEwWzBdLmxlbmd0aCwgcmVwbGFjZW1lbnQ6IHN0clJlcF82MTBbMV19KTtcbiAgICAgICAgdG90YWxJbmRleCArPSBzdHJSZXBfNjEwWzBdLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGFjY182MDk7XG4gICAgICB9LCBbXSwgUi56aXAoc3RyaW5nc182MDYsIHJlcGxhY2VtZW50c182MDgpKTtcbiAgICB9XG4gIH1cbiAgcmVhZChzdGFja182MTEgPSBbXSwgYl82MTIgPSBmYWxzZSwgc2luZ2xlRGVsaW1pdGVyXzYxMyA9IGZhbHNlKSB7XG4gICAgbGV0IHByZWZpeF82MTQgPSBMaXN0KCk7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGxldCB0b2sgPSB0aGlzLmFkdmFuY2UocHJlZml4XzYxNCwgYl82MTIpO1xuICAgICAgaWYgKHRvayBpbnN0YW5jZW9mIFN5bnRheCB8fCB0b2sgaW5zdGFuY2VvZiBUZXJtKSB7XG4gICAgICAgIHN0YWNrXzYxMS5wdXNoKHRvayk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodG9rKSkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShzdGFja182MTEsIHRvayk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKExpc3QuaXNMaXN0KHRvaykpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoc3RhY2tfNjExLCB0b2sudG9BcnJheSgpKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoaXNFT1NfNTAzKHRvaykpIHtcbiAgICAgICAgaWYgKHN0YWNrXzYxMVswXSAmJiBpc0xlZnREZWxpbWl0ZXJfNTA3KHN0YWNrXzYxMVswXS50b2tlbikpIHtcbiAgICAgICAgICB0aHJvdyB0aGlzLmNyZWF0ZVVuZXhwZWN0ZWQodG9rKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChpc0xlZnREZWxpbWl0ZXJfNTA3KHRvaykpIHtcbiAgICAgICAgaWYgKGlzTGVmdFN5bnRheF81MDUodG9rKSkge1xuICAgICAgICAgIHRoaXMuaW5zaWRlU3ludGF4VGVtcGxhdGUucHVzaCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbGluZSA9IHRvay5zbGljZS5zdGFydExvY2F0aW9uLmxpbmU7XG4gICAgICAgIGxldCBpbm5lckIgPSBpc0xlZnRCcmFjZV80OTgodG9rKSA/IGlzRXhwclByZWZpeF81MzgobGluZSwgYl82MTIpKHByZWZpeF82MTQpIDogdHJ1ZTtcbiAgICAgICAgbGV0IGlubmVyID0gdGhpcy5yZWFkKFtuZXcgU3ludGF4KHRvayldLCBpbm5lckIsIGZhbHNlKTtcbiAgICAgICAgbGV0IHN0eCA9IG5ldyBTeW50YXgoaW5uZXIsIHRoaXMuY29udGV4dCk7XG4gICAgICAgIHByZWZpeF82MTQgPSBwcmVmaXhfNjE0LmNvbmNhdChzdHgpO1xuICAgICAgICBzdGFja182MTEucHVzaChzdHgpO1xuICAgICAgICBpZiAoc2luZ2xlRGVsaW1pdGVyXzYxMykge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGlzUmlnaHREZWxpbWl0ZXJfNTA4KHRvaykpIHtcbiAgICAgICAgaWYgKHN0YWNrXzYxMVswXSAmJiAhaXNNYXRjaGluZ0RlbGltaXRlcnNfNTA5KHN0YWNrXzYxMVswXS50b2tlbiwgdG9rKSkge1xuICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlVW5leHBlY3RlZCh0b2spO1xuICAgICAgICB9XG4gICAgICAgIGxldCBzdHggPSBuZXcgU3ludGF4KHRvaywgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgc3RhY2tfNjExLnB1c2goc3R4KTtcbiAgICAgICAgaWYgKGxhc3RFbF81NDkodGhpcy5pbnNpZGVTeW50YXhUZW1wbGF0ZSkgJiYgaXNSaWdodFN5bnRheF81MDYodG9rKSkge1xuICAgICAgICAgIHRoaXMuaW5zaWRlU3ludGF4VGVtcGxhdGUucG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgc3R4ID0gbmV3IFN5bnRheCh0b2ssIHRoaXMuY29udGV4dCk7XG4gICAgICAgIHByZWZpeF82MTQgPSBwcmVmaXhfNjE0LmNvbmNhdChzdHgpO1xuICAgICAgICBzdGFja182MTEucHVzaChzdHgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gTGlzdChzdGFja182MTEpO1xuICB9XG4gIGFkdmFuY2UocHJlZml4XzYxNSwgYl82MTYpIHtcbiAgICBsZXQgc3RhcnRMb2NhdGlvbl82MTcgPSB0aGlzLmdldExvY2F0aW9uKCk7XG4gICAgdGhpcy5sYXN0SW5kZXggPSB0aGlzLmluZGV4O1xuICAgIHRoaXMubGFzdExpbmUgPSB0aGlzLmxpbmU7XG4gICAgdGhpcy5sYXN0TGluZVN0YXJ0ID0gdGhpcy5saW5lU3RhcnQ7XG4gICAgdGhpcy5za2lwQ29tbWVudCgpO1xuICAgIHRoaXMuc3RhcnRJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgdGhpcy5zdGFydExpbmUgPSB0aGlzLmxpbmU7XG4gICAgdGhpcy5zdGFydExpbmVTdGFydCA9IHRoaXMubGluZVN0YXJ0O1xuICAgIGlmICh0aGlzLnJlcGxhY2VtZW50SW5kZXggJiYgdGhpcy5yZXBsYWNlbWVudEluZGV4WzBdICYmIHRoaXMuaW5kZXggPj0gdGhpcy5yZXBsYWNlbWVudEluZGV4WzBdLmluZGV4KSB7XG4gICAgICBsZXQgcmVwID0gdGhpcy5yZXBsYWNlbWVudEluZGV4WzBdLnJlcGxhY2VtZW50O1xuICAgICAgdGhpcy5yZXBsYWNlbWVudEluZGV4LnNoaWZ0KCk7XG4gICAgICByZXR1cm4gcmVwO1xuICAgIH1cbiAgICBsZXQgY2hhckNvZGVfNjE4ID0gdGhpcy5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLmluZGV4KTtcbiAgICBpZiAoY2hhckNvZGVfNjE4ID09PSA5Nikge1xuICAgICAgbGV0IGVsZW1lbnQsIGl0ZW1zID0gW107XG4gICAgICBsZXQgc3RhcnRMb2NhdGlvbl82MTcgPSB0aGlzLmdldExvY2F0aW9uKCk7XG4gICAgICBsZXQgc3RhcnQgPSB0aGlzLmluZGV4O1xuICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgaWYgKGxhc3RFbF81NDkodGhpcy5pbnNpZGVTeW50YXhUZW1wbGF0ZSkpIHtcbiAgICAgICAgbGV0IHNsaWNlID0gdGhpcy5nZXRTbGljZShzdGFydCwgc3RhcnRMb2NhdGlvbl82MTcpO1xuICAgICAgICByZXR1cm4ge3R5cGU6IFJTWU5UQVhfNDk1LCB2YWx1ZTogXCJgXCIsIHNsaWNlOiBzbGljZX07XG4gICAgICB9XG4gICAgICBkbyB7XG4gICAgICAgIGVsZW1lbnQgPSB0aGlzLnNjYW5UZW1wbGF0ZUVsZW1lbnQoKTtcbiAgICAgICAgaXRlbXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgaWYgKGVsZW1lbnQuaW50ZXJwKSB7XG4gICAgICAgICAgZWxlbWVudCA9IHRoaXMucmVhZChbXSwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgIGFzc2VydChlbGVtZW50LnNpemUgPT09IDEsIFwic2hvdWxkIG9ubHkgaGF2ZSByZWFkIGEgc2luZ2xlIGRlbGltaXRlciBpbnNpZGUgYSB0ZW1wbGF0ZVwiKTtcbiAgICAgICAgICBpdGVtcy5wdXNoKGVsZW1lbnQuZ2V0KDApKTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAoIWVsZW1lbnQudGFpbCk7XG4gICAgICByZXR1cm4ge3R5cGU6IFRva2VuVHlwZS5URU1QTEFURSwgaXRlbXM6IExpc3QoaXRlbXMpfTtcbiAgICB9IGVsc2UgaWYgKGNoYXJDb2RlXzYxOCA9PT0gMzUpIHtcbiAgICAgIGxldCBzdGFydExvY2F0aW9uXzYxNyA9IHRoaXMuZ2V0TG9jYXRpb24oKTtcbiAgICAgIGxldCBzdGFydCA9IHRoaXMuaW5kZXg7XG4gICAgICBsZXQgc2xpY2UgPSB0aGlzLmdldFNsaWNlKHN0YXJ0LCBzdGFydExvY2F0aW9uXzYxNyk7XG4gICAgICB0aGlzLmluZGV4Kys7XG4gICAgICBpZiAodGhpcy5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLmluZGV4KSA9PT0gOTYpIHtcbiAgICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgICByZXR1cm4ge3R5cGU6IExTWU5UQVhfNDk0LCB2YWx1ZTogXCIjYFwiLCBzbGljZTogc2xpY2V9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHt0eXBlOiBUb2tlblR5cGUuSURFTlRJRklFUiwgdmFsdWU6IFwiI1wiLCBzbGljZTogc2xpY2V9O1xuICAgIH1cbiAgICBsZXQgbG9va2FoZWFkXzYxOSA9IHN1cGVyLmFkdmFuY2UoKTtcbiAgICBpZiAobG9va2FoZWFkXzYxOS50eXBlID09PSBUb2tlblR5cGUuRElWICYmIGlzUmVnZXhQcmVmaXhfNTQ4KGJfNjE2KShwcmVmaXhfNjE1KSkge1xuICAgICAgcmV0dXJuIHN1cGVyLnNjYW5SZWdFeHAoXCIvXCIpO1xuICAgIH1cbiAgICByZXR1cm4gbG9va2FoZWFkXzYxOTtcbiAgfVxuICBzY2FuVGVtcGxhdGVFbGVtZW50KCkge1xuICAgIGxldCBzdGFydExvY2F0aW9uXzYyMCA9IHRoaXMuZ2V0TG9jYXRpb24oKTtcbiAgICBsZXQgc3RhcnRfNjIxID0gdGhpcy5pbmRleDtcbiAgICB3aGlsZSAodGhpcy5pbmRleCA8IHRoaXMuc291cmNlLmxlbmd0aCkge1xuICAgICAgbGV0IGNoID0gdGhpcy5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLmluZGV4KTtcbiAgICAgIHN3aXRjaCAoY2gpIHtcbiAgICAgICAgY2FzZSA5NjpcbiAgICAgICAgICBsZXQgc2xpY2UgPSB0aGlzLmdldFNsaWNlKHN0YXJ0XzYyMSwgc3RhcnRMb2NhdGlvbl82MjApO1xuICAgICAgICAgIHRoaXMuaW5kZXgrKztcbiAgICAgICAgICByZXR1cm4ge3R5cGU6IFRva2VuVHlwZS5URU1QTEFURSwgdGFpbDogdHJ1ZSwgaW50ZXJwOiBmYWxzZSwgc2xpY2U6IHNsaWNlfTtcbiAgICAgICAgY2FzZSAzNjpcbiAgICAgICAgICBpZiAodGhpcy5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLmluZGV4ICsgMSkgPT09IDEyMykge1xuICAgICAgICAgICAgbGV0IHNsaWNlID0gdGhpcy5nZXRTbGljZShzdGFydF82MjEsIHN0YXJ0TG9jYXRpb25fNjIwKTtcbiAgICAgICAgICAgIHRoaXMuaW5kZXggKz0gMTtcbiAgICAgICAgICAgIHJldHVybiB7dHlwZTogVG9rZW5UeXBlLlRFTVBMQVRFLCB0YWlsOiBmYWxzZSwgaW50ZXJwOiB0cnVlLCBzbGljZTogc2xpY2V9O1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmluZGV4Kys7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgOTI6XG4gICAgICAgICAge1xuICAgICAgICAgICAgbGV0IG9jdGFsID0gdGhpcy5zY2FuU3RyaW5nRXNjYXBlKFwiXCIsIG51bGwpWzFdO1xuICAgICAgICAgICAgaWYgKG9jdGFsICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgdGhyb3cgdGhpcy5jcmVhdGVJTExFR0FMKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyB0aGlzLmNyZWF0ZUlMTEVHQUwoKTtcbiAgfVxufVxuIl19